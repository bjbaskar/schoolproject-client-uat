(this["webpackJsonpsivanandha-webapp"]=this["webpackJsonpsivanandha-webapp"]||[]).push([[27],{1394:function(e,t,a){"use strict";a.r(t);var n=a(10),l=a(0),r=a.n(l),c=a(157),o=a(1043),s=a(1028),m=a(1017),i=a(16),u=a(8),E=(a(158),a(197),a(3),a(14)),d=a(13),f=a.n(d);function p(){var e=Object(E.a)(["\n\tquery getStudentCount($classId: String) {\n\t\tgetStudentCount(classId: $classId) {\n\t\t\tclassId\n\t\t\tname\n\t\t\tboys\n\t\t\tgirls\n\t\t\ttotal\n\t\t}\n\t}\n"]);return p=function(){return e},e}function b(){var e=Object(E.a)(["\n\tquery($filter: String) {\n\t\tgetLoginCount(filter: $filter) {\n\t\t\tusername\n\t\t\tos\n\t\t\tbrowser\n\t\t\tcpu\n\t\t\tdevice\n\t\t\tengine\n\t\t\tlastlogin\n\t\t\tcount\n\t\t}\n\t\tgetLoginCountChart(filter: $filter) {\n\t\t\tlastlogin\n\t\t\tcount\n\t\t}\n\t}\n"]);return b=function(){return e},e}function g(){var e=Object(E.a)(["\n\tquery($filter: String) {\n\t\tgetLoginCountChart(filter: $filter) {\n\t\t\tlastlogin\n\t\t\tcount\n\t\t}\n\t}\n"]);return g=function(){return e},e}function h(){var e=Object(E.a)(["\n\tquery($filter: String) {\n\t\tgetLoginCount(filter: $filter) {\n\t\t\tusername\n\t\t\tos\n\t\t\tbrowser\n\t\t\tcpu\n\t\t\tdevice\n\t\t\tengine\n\t\t\tlastlogin\n\t\t\tcount\n\t\t}\n\t}\n"]);return h=function(){return e},e}f()(h()),f()(g());var v=f()(b()),w=f()(p()),y=a(194),N=a(963),x=a(1011),j=a(64),O=a.n(j);r.a.memo((function(){var e=Object(l.useState)(O()()),t=Object(n.a)(e,2),a=t[0];return t[1],r.a.createElement(y.a,{className:"w-full rounded-8 shadow-none border-1"},r.a.createElement("div",{className:"flex items-center justify-between pr-4 pl-16 pt-4"},r.a.createElement(c.a,{className:"text-16"},a.format("dddd")),r.a.createElement(N.a,{"aria-label":"more"},r.a.createElement(x.a,null,"more_vert"))),r.a.createElement("div",{className:"text-center px-24 py-32"},r.a.createElement(c.a,{className:"text-24 leading-tight",color:"textSecondary"},a.format("MMMM")),r.a.createElement(c.a,{className:"text-72 leading-tight",color:"textSecondary"},a.format("D")),r.a.createElement(c.a,{className:"text-24 leading-tight",color:"textSecondary"},a.format("Y"))))}));var S=a(1024),C=a(1025),k=a(974),L=a(1376),D=a(1377),A=a(1378),P=a(1379),T=a(1380),I=a(45),M=a(1015),Y=a(218),R=a(17),F=a(1160),U=(a(19),a(75)),B=Object(m.a)((function(e){return{root:{background:"linear-gradient(to right, #F7F7F7 0%, #e5e5e5 100%)"},tooltipBg:{background:"linear-gradient(to right, #F7F7F7 0%, #f5f6f7 100%)",margin:16}}}));var $=r.a.memo((function(e){var t=Object(u.c)((function(e){return e.fuse.settings.mainThemeLight})),a=B(e),o=(Object(I.a)(),Object(l.useState)("LAST7DAYS")),s=Object(n.a)(o,2),m=s[0],E=s[1],d=Object(l.useState)("Last 7 days"),f=Object(n.a)(d,2),p=f[0],b=f[1],g=Object(l.useState)(!0),h=Object(n.a)(g,2),w=h[0],N=h[1],x=Object(Y.b)(v,{variables:{filter:m}}),j=Object(n.a)(x,2),$=j[0],K=j[1],q=K.loading,H=K.error,z=K.data,G=(z=void 0===z?{}:z).getLoginCount,J=void 0===G?[]:G,W=z.getLoginCountChart,_=void 0===W?[]:W;Object(l.useEffect)((function(){$()}),[]);var Q=function(e){return"LAST7DAYS"===m?O()(e).format("DD-MMM"):O()(e).format("hh a")},V=function(e){var t,n=e.active,l=e.payload,c=e.label;return n&&l?(t="LAST7DAYS"===m?O()(c).format("DD-MMM"):O()(c).format("hh a"),r.a.createElement(y.a,{className:a.tooltipBg},r.a.createElement("p",{className:"label m-8 pb-8 pt-8"},"Total Users : ".concat(l[0].value)),r.a.createElement("p",{className:"intro m-8 pb-8"},"Logged on  : ".concat(t)))):null};if(H)return null;if(q&&!J&&!_)return r.a.createElement(U.j,null);var X=R.a.orderBy(_,["lastlogin"],["asc"]);return r.a.createElement(M.a,{theme:t},r.a.createElement(y.a,{className:"w-full rounded-8 shadow-none border-1"},r.a.createElement("div",{className:"flex items-center justify-between px-16 h-64 border-b-1"},r.a.createElement(i.a,{delay:100},r.a.createElement("div",{className:"flex-col"},r.a.createElement(c.a,{className:"h2",color:"textPrimary"},"User Login History"),r.a.createElement(c.a,{className:"h5",color:"textSecondary"},"Unique Users by ",p))),r.a.createElement("div",null,r.a.createElement(S.a,{className:"mt-8 mb-8 mr-32",label:"Alternate Chart",control:r.a.createElement(C.a,{checked:w,id:"barChart",name:"barChart",onChange:function(e){N(e.target.checked)}})}),r.a.createElement(k.a,{native:!0,value:m,onChange:function(e){E(e.target.value),b(e.target.options[e.target.selectedIndex].label)},inputProps:{name:"currentRange"},disableUnderline:!0},r.a.createElement("option",{value:"TODAY"},"Today"),r.a.createElement("option",{value:"YESTERDAY"},"Yesterday"),r.a.createElement("option",{value:"LAST7DAYS"},"Last 7 days")))),r.a.createElement("div",{className:"container relative h-200 sm:h-256 w-11/12"},r.a.createElement(F.i,null,w?r.a.createElement(F.b,{className:"mt-32",data:X,margin:{top:10,right:30,left:0,bottom:0}},r.a.createElement("defs",null,r.a.createElement("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1"},r.a.createElement("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),r.a.createElement("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:0})),r.a.createElement("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1"},r.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),r.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),r.a.createElement(F.k,{dataKey:"lastlogin",tickFormatter:Q}),r.a.createElement(F.l,null),r.a.createElement(F.e,{strokeDasharray:"3 3"}),r.a.createElement(F.j,{content:r.a.createElement(V,null)}),r.a.createElement(F.a,{type:"monotone",dataKey:"count",stroke:"#82ca9d",fillOpacity:1,fill:"url(#colorPv)"})):r.a.createElement(F.f,{className:"mt-32",data:X,margin:{top:10,right:30,left:0,bottom:0}},r.a.createElement(F.e,{stroke:"#f5f5f5"}),r.a.createElement(F.k,{dataKey:"lastlogin",tickFormatter:Q}),r.a.createElement(F.l,null),r.a.createElement(F.j,{content:r.a.createElement(V,null)}),r.a.createElement(F.c,{dataKey:"count",barSize:20,fill:"#413ea0"}),r.a.createElement(F.h,{type:"monotone",dataKey:"count",stroke:"#ff7300"})))),r.a.createElement("div",{className:"flex items-center justify-between px-16 h-64 border-t-1 border-b-1 mt-32\t"},r.a.createElement(c.a,{className:"h2",color:"textPrimary"},"Login History Details")),r.a.createElement("div",{className:"table-responsive"},r.a.createElement(L.a,{className:"w-full min-w-full",size:"small","aria-label":"login details"},r.a.createElement(D.a,null,r.a.createElement(A.a,null,r.a.createElement(P.a,{className:"whitespace-no-wrap"},"User Name"),r.a.createElement(P.a,{className:"whitespace-no-wrap"},"Last Login"),r.a.createElement(P.a,{className:"whitespace-no-wrap"},"No. Of Logins"),r.a.createElement(P.a,{className:"whitespace-no-wrap"},"Platform"),r.a.createElement(P.a,{className:"whitespace-no-wrap"},"Browser"),r.a.createElement(P.a,{className:"whitespace-no-wrap"},"Device"),r.a.createElement(P.a,{className:"whitespace-no-wrap"},"Engine"))),r.a.createElement(T.a,null,J.map((function(e,t){return r.a.createElement(A.a,{key:t},r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.username)),r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.lastlogin)),r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.count)),r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.os)),r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.browser)),r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.device+" - "+e.cpu)),r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.engine)))})))))))}));Object(m.a)((function(e){return{root:{background:"linear-gradient(to right, #F7F7F7 0%, #e5e5e5 100%)"}}}));var K=r.a.memo((function(e){Object(u.c)((function(e){return e.fuse.settings.mainThemeLight}));var t=Object(l.useState)("LAST7DAYS"),a=Object(n.a)(t,2),o=a[0],s=a[1],m=Object(l.useState)("All Class and Sections"),E=Object(n.a)(m,2),d=E[0],f=E[1],p=Object(Y.b)(w),b=Object(n.a)(p,2),g=b[0],h=b[1],v=h.loading,N=h.error,x=h.data,j=(x=void 0===x?{}:x).getStudentCount,O=void 0===j?[]:j;if(Object(l.useEffect)((function(){g({variables:{classId:null}})}),[]),N)return null;if(v&&!O.length)return r.a.createElement(U.j,null);var S=O;return r.a.createElement(y.a,{className:"w-full rounded-8 shadow-none border-1"},r.a.createElement("div",{className:"flex items-center justify-between px-16 h-64 border-b-1"},r.a.createElement(i.a,{delay:100},r.a.createElement("div",{className:"flex-col"},r.a.createElement(c.a,{className:"h2",color:"textPrimary"},"Classwise Summary"),r.a.createElement(c.a,{className:"h5",color:"textSecondary"},"Showing ",d))),r.a.createElement("div",null,r.a.createElement(k.a,{native:!0,value:o,onChange:function(e){s(e.target.value),f(e.target.options[e.target.selectedIndex].label)},inputProps:{name:"currentRange"},disableUnderline:!0},r.a.createElement("option",{value:"PREPRIMARY"},"Pre-Primary"),r.a.createElement("option",{value:"PRIMARY"},"Primary"),r.a.createElement("option",{value:"SECONDARY"},"Secondary")))),r.a.createElement("div",{className:"container relative h-200 sm:h-256 w-full"},r.a.createElement(F.i,null,r.a.createElement(F.d,{className:"mt-32",data:S,margin:{top:20,right:30,left:20,bottom:5}},r.a.createElement(F.e,{strokeDasharray:"3 3"}),r.a.createElement(F.k,{dataKey:"name"}),r.a.createElement(F.l,null),r.a.createElement(F.j,null),r.a.createElement(F.g,null),r.a.createElement(F.c,{dataKey:"boys",stackId:"a",fill:"#8884d8"}),r.a.createElement(F.c,{dataKey:"girls",stackId:"a",fill:"#82ca9d"})))),r.a.createElement("div",{className:"flex items-center justify-between px-16 h-64 border-t-1 border-b-1 mt-32\t"},r.a.createElement(c.a,{className:"h2",color:"textPrimary"},"Classwise Summary Details")),r.a.createElement("div",{className:"table-responsive h-200 w-full"},r.a.createElement(L.a,{className:"w-full min-w-full",size:"small","aria-label":"stud total"},r.a.createElement(D.a,null,r.a.createElement(A.a,null,r.a.createElement(P.a,{className:"whitespace-no-wrap"},"#"),r.a.createElement(P.a,{className:"whitespace-no-wrap"},"Class / Section"),r.a.createElement(P.a,{className:"whitespace-no-wrap"},"Boys"),r.a.createElement(P.a,{className:"whitespace-no-wrap"},"Girls"),r.a.createElement(P.a,{className:"whitespace-no-wrap"},"Total"))),r.a.createElement(T.a,null,S.map((function(e,t){return r.a.createElement(A.a,{key:t},r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,t+1)),r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.name)),r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.boys)),r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.girls)),r.a.createElement(P.a,{component:"th",scope:"row"},r.a.createElement(c.a,null,e.boys+e.girls)))}))))))})),q=Object(m.a)((function(e){return{content:{"& canvas":{maxHeight:"100%"}},selectedProject:{background:e.palette.primary.main,color:e.palette.primary.contrastText,borderRadius:"8px 0 0 0"},projectMenuButton:{background:e.palette.primary.main,color:e.palette.primary.contrastText,borderRadius:"0 8px 0 0",marginLeft:1},iconColor:{color:"#848584"}}}));t.default=function(e){var t=Object(u.c)((function(e){return e.auth.user})),a=Object(l.useState)(""),m=Object(n.a)(a,2),E=m[0],d=m[1],f=Object(l.useState)(0),p=Object(n.a)(f,2),b=p[0],g=p[1],h=q(e),v=Object(l.useRef)(null);return Object(l.useEffect)((function(){var e="";t&&"staff"===t.usertype?e=t.staff.firstname:t&&"student"===t.usertype&&(e=t.students.firstname),d(e)}),[]),r.a.createElement(i.m,{classes:{header:"min-h-160 h-160",toolbar:"min-h-48 h-48",rightSidebar:"w-288",content:h.content},header:r.a.createElement("div",{className:"flex flex-col justify-between flex-1 px-24 pt-24"},r.a.createElement("div",{className:"flex justify-between items-start"},r.a.createElement("div",{className:"flex-col"},r.a.createElement(c.a,{className:"py-0 sm:py-24",variant:"h4"},"Welcome back, ",E,"!")))),contentToolbar:r.a.createElement(o.a,{value:b,onChange:function(e,t){g(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"off",className:"w-full border-b-1 px-24"},r.a.createElement(s.a,{className:"text-14 font-600 normal-case",label:"Home"}),r.a.createElement(s.a,{className:"text-14 font-600 normal-case",label:"Summary"}),r.a.createElement(s.a,{className:"text-14 font-600 normal-case",label:"Staff Members"})),content:r.a.createElement("div",{className:"p-12"},0===b&&r.a.createElement(i.b,{className:"flex flex-wrap",enter:{animation:"transition.slideUpBigIn"}},r.a.createElement("div",{className:"widget flex w-full p-12"},r.a.createElement(K,null)),r.a.createElement("div",{className:"widget flex w-full p-12"},r.a.createElement($,e))),1===b&&r.a.createElement(i.b,{className:"flex flex-wrap",enter:{animation:"transition.slideUpBigIn"}}),2===b&&r.a.createElement(i.b,{className:"flex flex-wrap",enter:{animation:"transition.slideUpBigIn"}},r.a.createElement("div",{className:"widget flex w-full p-12"}))),ref:v})}}}]);