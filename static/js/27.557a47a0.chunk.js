(this["webpackJsonpsivanandha-vidyashram-seithur"]=this["webpackJsonpsivanandha-vidyashram-seithur"]||[]).push([[27],{1397:function(e,a,t){"use strict";t.r(a);var n=t(31),l=t(8),r=t(10),c=t(0),o=t.n(c),i=t(174),m=t(812),s=t(849),d=t(824),f=t(854),u=t(820),E=t(851),b=t(832),h=t(1369),p=t(79),v=t.n(p),g=t(16),x=t(36),N=t(11),O=t(192),j=t(87),w=t(101),S=t(70),y=t(21),C=t(334),T=t(195),D=t(993),F=t(173),I=t(856),L=t(826),M=t(757),Y=t(32),_=t.n(Y),A={upName:"",uploadType:"",size:"",type:""},H={open:!1,data:""};var P=function(e){var a=Object(N.b)(),t=e.staffId,n=e.profile,l=Object(c.useState)(!1),s=Object(r.a)(l,2),d=s[0],f=s[1],u=Object(w.b)(A),E=u.form,b=(u.setForm,u.setInForm,u.handleChange),h=Object(c.useState)(H),p=Object(r.a)(h,2),x=p[0],j=p[1],T=Object(O.b)(C.g),D=Object(r.a)(T,2),Y=D[0],P=D[1],R=P.loading,k=(P.error,P.data),z=(k=void 0===k?{}:k).getDocuments,B=void 0===z?[]:z,V=P.refetch,U=Object(O.c)(C.b,{onCompleted:function(e){var t=e.data;t&&t.delDocuments&&(a(y.j({message:"Selected Document deleted successfully",variant:"info"})),V())}}),W=Object(r.a)(U,2),q=W[0],G=W[1];Object(c.useEffect)((function(){t&&Y({variables:{id:t,searchfor:"STAFF"}})}),[]);var J=function(e,a){e?j({open:e,data:a}):j({open:!1})},X=function(e){!function(e){var a=e.id,t=e.modulename,n=e.docid;q({variables:{id:a,modulename:t,doctype:"DOCS",docid:n}})}(e),j({open:!1})};if(!t)return o.a.createElement("h1",null,"Staff Id not found");if(R)return o.a.createElement(g.i,null);var K=B;return o.a.createElement(c.Fragment,null,o.a.createElement(F.a,{elevation:1,style:{background:"#F7F7F7"}},o.a.createElement(v.a,null,o.a.createElement(i.a,{variant:"h6",color:"inherit",className:"p-8"},"Profile Photo"),o.a.createElement("div",{className:"p-16 sm:p-8 my-16 flex flex-row"},o.a.createElement(S.z,{moduleId:"upload_staff_photos",moduleName:"STAFF",upName:"PROFILEPHOTO",uploadType:"PHOTOS",staffId:t,canEnable:!0,displayName:"Change Profile Photo",mediaUrl:null===n||void 0===n?void 0:n.photo})))),o.a.createElement(F.a,{elevation:1,className:"mt-32",style:{background:"#F7F7F7"}},o.a.createElement(v.a,{onValid:function(){f(!0)},onInvalid:function(){f(!1)}},o.a.createElement(i.a,{variant:"h6",color:"inherit",className:"p-8"},"Attach Documents"),o.a.createElement("div",{className:"p-16 sm:p-8 mt-16 flex flex-col"},o.a.createElement(g.x,{className:"mb-16 w-1/2",autoFocus:!0,name:"upName",label:"Name of the Document",validations:{maxLength:50},validationErrors:{maxLength:"You can not type in more than 50 characters"},variant:"outlined",required:!0,onChange:b}),o.a.createElement(S.z,{moduleId:"upload_staff_docs",moduleName:"STAFF",upName:E.upName,uploadType:"DOCS",staffId:t,canEnable:d,displayName:"Attach Documents"}))),o.a.createElement(S.o,{cssClass:"-striped -highlight border-0 min-w-xl ml-16 mt-16 pr-16",data:K,defaultSorted:[{id:"createdon",desc:!0}],columns:[{id:"media",Header:"",accessor:"mediaurl",sortable:!1,Cell:function(e){return o.a.createElement("div",{className:"pl-8"},o.a.createElement(I.a,{src:e.row.original.mediaurl}))}},{id:"name",Header:"Name",accessor:"name"},{id:"mname",Header:"Module Name",accessor:"modulename"},{id:"filesize",Header:"Size",accessor:"filesize"},{id:"filetype",Header:"Type",accessor:"filetype"},{id:"crby",Header:"Created by",accessor:"createdby"},{id:"cron",Header:"Created on",accessor:"createdon",Cell:function(e){return o.a.createElement("div",{className:"pl-8"},e.row.original.createdon?_()(e.row.original.createdon).format("Do MMM YYYY"):"")}},{id:"controls",Header:"",sortable:!1,Cell:function(e){return o.a.createElement("div",{className:"flex items-center"},o.a.createElement(L.a,{title:"Download"},o.a.createElement(M.a,{onClick:function(a){var t;a.stopPropagation(),t=e.row.original.mediaurl,window.open(t,"Data","height=250,width=250")}},o.a.createElement(m.a,null,"cloud_download"))),o.a.createElement(L.a,{title:"Delete / Inactivate"},o.a.createElement(c.Fragment,null,o.a.createElement(M.a,{onClick:function(a){a.stopPropagation(),J(!0,e.row.original)}},o.a.createElement(m.a,null,"delete")))))}}]})),o.a.createElement(S.e,{open:x.open,title:"Are you sure you want to delete this Document?",onConfirm:function(){return X(x.data)},onCancel:function(){return J(!1)}},o.a.createElement(c.Fragment,null,o.a.createElement("table",null,o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"flex items-end m-8"},"Name"),o.a.createElement("td",null,x.data&&x.data.name)),o.a.createElement("tr",null,o.a.createElement("th",{className:"flex items-end m-8"},"Size"),o.a.createElement("td",null,x.data&&x.data.filesize)))),G.error&&o.a.createElement(i.a,{className:"pt-32"},"Error : Please try again! ",o.a.createElement("br",null),G.error.message," ",o.a.createElement("br",null)))))},R={id:"",aadhaarno:"",staffno:"",firstname:"",lastname:"",gender:"Female",designation:"Teacher",dob:new Date,doj:new Date,nationality:"Indian",religion:"Hindu",castecategory:"",community:"",mothertongue:"Tamil",bloodgroup:"",identification:"",isactive:!0,notes:""};a.default=Object(T.a)("staff",D.a)((function(e){var a,t=Object(N.b)(),p=Object(c.useRef)(null),T=Object(j.g)(),D=Object(c.useState)(!0),F=Object(r.a)(D,2),I=F[0],L=F[1],M=Object(c.useState)(!1),Y=Object(r.a)(M,2),_=Y[0],A=Y[1],H=Object(c.useState)(0),k=Object(r.a)(H,2),z=k[0],B=k[1],V=Object(c.useState)(C.a),U=Object(r.a)(V,2),W=U[0],q=U[1],G=Object(w.b)(R),J=G.form,X=G.handleChange,K=G.setForm,Q=G.setInForm,Z=Object(N.c)((function(e){return e.staff.staffReducer.selectedStaff})),$=e.match.params.staffId,ee=Object(O.b)(C.h),ae=Object(r.a)(ee,2),te=ae[0],ne=ae[1],le=ne.loading,re=(ne.error,ne.data),ce=Object(O.c)(W,{onCompleted:function(e){(e&&e.addStaffProfile||e&&e.editStaffProfile)&&(t(y.j({message:"Staff details saved successfully",variant:"success"})),fe())}}),oe=Object(r.a)(ce,2),ie=oe[0],me=oe[1],se=me.loading;me.error,Object(c.useEffect)((function(){return function(){var a,t=e.match.params.staffId;"new"===t?(a=C.a,K(Object(l.a)({},R)),L(!1)):Z&&Z.id?Z&&Z.id&&(a=C.d,K(Z),L(!0)):(te({variables:{id:t,isactive:!0}}),a=C.d,L(!0)),q(a)}(),function(){q(null),K(null)}}),[e.match.params]),Object(c.useEffect)((function(){re&&re.getStaff&&K(re.getStaff)}),[re]);var de=function(e,a){Q(a,e.label)},fe=function(){T.push({pathname:"/staff/list",data:!0})};return se?o.a.createElement(S.s,{message:"Saving data..."}):le&&!re?o.a.createElement(S.s,{message:"Loading Staff details..."}):o.a.createElement(g.l,{classes:{toolbar:"p-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:J&&o.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},o.a.createElement("div",{className:"flex flex-col items-start max-w-full"},o.a.createElement(g.a,{animation:"transition.slideRightIn",delay:300},o.a.createElement(i.a,{className:"normal-case flex items-center sm:mb-12",component:x.a,role:"button",to:"/staff/list",color:"inherit"},o.a.createElement(m.a,{className:"mr-4 text-20"},"arrow_back"),"Staff")),o.a.createElement("div",{className:"flex items-center max-w-full"},o.a.createElement(g.a,{animation:"transition.expandIn",delay:300},o.a.createElement("img",{className:"w-32 sm:w-48 mr-8 sm:mr-16 rounded",src:"assets/images/ecommerce/product-image-placeholder.png",alt:J.name})),o.a.createElement("div",{className:"flex flex-col min-w-0"},o.a.createElement(g.a,{animation:"transition.slideLeftIn",delay:300},o.a.createElement(i.a,{className:"text-16 sm:text-20 truncate"},J.firstname?J.firstname+" "+J.lastname:"New Staff")),o.a.createElement(g.a,{animation:"transition.slideLeftIn",delay:300},o.a.createElement(i.a,{variant:"caption"},"Staff Detail")))))),contentToolbar:o.a.createElement(s.a,{value:z,onChange:function(e,a){B(a)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",classes:{root:"w-full h-64"}},o.a.createElement(d.a,{className:"h-64 normal-case",label:"Basic Info"}),I&&o.a.createElement(d.a,{className:"h-64 normal-case",label:"Documents"})),content:J&&o.a.createElement("div",{className:"flex flex-col items-start max-w-full"},o.a.createElement("div",{className:"p-16 sm:p-24 max-w-2xl"},0===z&&o.a.createElement(c.Fragment,null,o.a.createElement(v.a,{className:"flex flex-col w-full",onValid:function(){A(!0)},onInvalid:function(){A(!1)},ref:p,onValidSubmit:function(){ie({variables:Object(l.a)(Object(l.a)({},R),J)})}},o.a.createElement("div",{className:"px-8 sm:px-8 mt-16 flex flex-row justify-between"},o.a.createElement(g.x,(a={autoFocus:!0,label:"Aadhaar No."},Object(n.a)(a,"autoFocus",!0),Object(n.a)(a,"id","aadhaarno"),Object(n.a)(a,"name","aadhaarno"),Object(n.a)(a,"value",J.aadhaarno),Object(n.a)(a,"variant","outlined"),Object(n.a)(a,"fullWidth",!0),Object(n.a)(a,"validations",{maxLength:50}),Object(n.a)(a,"onChange",X),a)),o.a.createElement(g.x,{className:"ml-16",label:"Staff No.",id:"staffno",name:"staffno",value:J.staffno,variant:"outlined",fullWidth:!0,validations:{maxLength:50},onChange:X,disabled:!0})),o.a.createElement("div",{className:"px-8 sm:px-8 mt-16 flex flex-row justify-between"},o.a.createElement(g.x,{required:!0,label:"First Name",id:"firstname",name:"firstname",value:J.firstname,variant:"outlined",fullWidth:!0,validations:{maxLength:50},onChange:X}),o.a.createElement(g.x,{className:"ml-16",required:!0,label:"Last Name",id:"lastname",name:"lastname",value:J.lastname,variant:"outlined",fullWidth:!0,validations:{maxLength:50},onChange:X})),o.a.createElement("div",{className:"px-8 sm:px-8 mt-16 flex flex-row"},o.a.createElement("div",{className:"w-1/2 flex justify-between"},o.a.createElement(h.a,{label:"Date of Birth",inputVariant:"outlined",value:J.dob,onChange:function(e){return Q("dob",e)},className:"mt-8 mb-16",format:"DD-MMM-YYYY"}),o.a.createElement(h.a,{label:"Date of Join",inputVariant:"outlined",value:J.doj,onChange:function(e){return Q("doj",e)},className:"mt-8 mb-16 ml-8 mr-8",format:"DD-MMM-YYYY"})),o.a.createElement("div",{className:"w-1/2 flex justify-between"},o.a.createElement(f.a,{className:"ml-16","aria-label":"gender",name:"gender",value:J.gender,onChange:X},o.a.createElement(u.a,{value:"Female",control:o.a.createElement(E.a,null),label:"Female"}),o.a.createElement(u.a,{value:"Male",control:o.a.createElement(E.a,null),label:"Male"})),o.a.createElement(g.x,{className:"mb-8 mt-8",type:"text",name:"designation",label:"Designation",value:J.designation,validations:{maxLength:50},validationErrors:{maxLength:"You can not type in more than 50 characters"},variant:"outlined",onChange:X}))),o.a.createElement("div",{className:"px-8 sm:px-8 mt-16 flex flex-row"},o.a.createElement(S.f,{formName:J,filterName:"MOTHER_TONGUE",fieldName:"mothertongue",label:"Mother Tongue",cssClass:"w-1/2",onDDChange:de}),o.a.createElement(S.f,{formName:J,filterName:"RELIGION",fieldName:"religion",label:"Religion",cssClass:"w-1/2 ml-16",onDDChange:de})),o.a.createElement("div",{className:"px-8 sm:px-8 mt-16 flex flex-row"},o.a.createElement(S.f,{formName:J,filterName:"COMMUNITY",fieldName:"community",label:"Community",cssClass:"w-1/2",onDDChange:de}),o.a.createElement(S.b,{formName:J,onDDChange:function(e,a){Q(a,e.value)},cssClass:" min-h-56 w-1/2 ml-16"})),o.a.createElement("div",{className:"px-8 sm:px-8 mt-16 flex flex-row"},o.a.createElement(S.f,{formName:J,filterName:"BLOOD_GROUP",fieldName:"bloodgroup",label:"Bloodgroup",cssClass:"w-1/2",onDDChange:de}),o.a.createElement(g.x,{className:"mb-8 ml-16 w-1/2",type:"text",name:"identification",label:"Identification",value:J.identification,multiline:!0,rows:5,validations:{maxLength:250},validationErrors:{maxLength:"You can not type in more than 250 characters"},variant:"outlined",onChange:X})))),1===z&&I&&o.a.createElement(P,{staffId:$,profile:J})),o.a.createElement(b.a,{className:"whitespace-no-wrap normal-case self-center mb-32",variant:"contained",color:"secondary",disabled:!_,onClick:function(){p.current.submit()}},"Save"))})}))},919:function(e,a,t){"use strict";var n={};t.r(n),t.d(n,"SET_SEARCH_TEXT",(function(){return l})),t.d(n,"SET_STAFF_SELECTED",(function(){return r})),t.d(n,"setSearchText",(function(){return c})),t.d(n,"setSelectedStaff",(function(){return o}));var l="[STAFF] SET SEARCH TEXT",r="[STAFF] SET STAFF SELECTED";function c(e){return{type:l,searchText:e.target.value}}function o(e){return{type:r,data:e}}t.d(a,"a",(function(){return n}))},993:function(e,a,t){"use strict";var n=t(47),l=t(8),r=t(919),c={selectedStaff:{},searchText:"",dialog:{type:"edit",props:{open:!1},data:null,mode:null}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case r.a.SET_SEARCH_TEXT:return Object(l.a)(Object(l.a)({},e),{},{searchText:a.searchText});case r.a.SET_STAFF_SELECTED:return Object(l.a)(Object(l.a)({},e),{},{selectedStaff:a.data});default:return e}},i=Object(n.d)({staffReducer:o});a.a=i}}]);